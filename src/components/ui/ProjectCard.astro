---
interface Props {
  category: string;
  image: string;
  imageAlt?: string;
  number: string;
  total: string;
  tag: string;
  title: string;
  href?: string;
  modalImage?: string; // Путь к фото для модального окна (если указан - открывается модалка вместо перехода)
}

const {
  category,
  image,
  imageAlt = '',
  number,
  total,
  tag,
  title,
  href = '#',
  modalImage
} = Astro.props;

const isModal = !!modalImage;
---

<article class="project-card">
  <div class="project-card__inner">
    
    <!-- Left: Category Label -->
    <div class="project-card__category">
      <span class="text-xl font-semibold text-bf-dark leading-tight">
        {category}
      </span>
    </div>
    
    <!-- Center: Image -->
    <div class="project-card__image-wrap">
      {isModal ? (
        <a
          href="#"
          class="project-card__image-link group"
          data-modal-image={modalImage}
          data-modal-alt={title}
        >
          <img
            src={image}
            alt={imageAlt || title}
            class="project-card__image"
            loading="lazy"
          />

          <!-- Hover overlay -->
          <div class="project-card__overlay">
            <span class="project-card__view-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </div>
        </a>
      ) : (
        <a href={href} class="project-card__image-link group">
          <img
            src={image}
            alt={imageAlt || title}
            class="project-card__image"
            loading="lazy"
          />

          <!-- Hover overlay -->
          <div class="project-card__overlay">
            <span class="project-card__view-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </div>
        </a>
      )}
    </div>
    
    <!-- Right: Meta Info -->
    <div class="project-card__meta">
      <!-- Counter -->
      <div class="project-card__counter">
        <span class="text-h4 font-medium text-bf-black">{number}</span>
        <span class="text-h4 font-medium text-bf-gray"> / {total}</span>
      </div>
      
      <!-- Tag -->
      <div class="project-card__tag">
        <span class="bg-bf-beige text-bf-black text-small font-medium px-3.5 py-1 rounded-full">
          {tag}
        </span>
      </div>
    </div>
    
  </div>
  
  <!-- Title -->
  {isModal ? (
    <a
      href="#"
      class="project-card__title group"
      data-modal-image={modalImage}
      data-modal-alt={title}
    >
      <span class="text-h3 font-medium text-bf-black underline underline-offset-4 decoration-1 group-hover:text-bf-primary transition-colors duration-300">
        {title}
      </span>
    </a>
  ) : (
    <a href={href} class="project-card__title group">
      <span class="text-h3 font-medium text-bf-black underline underline-offset-4 decoration-1 group-hover:text-bf-primary transition-colors duration-300">
        {title}
      </span>
    </a>
  )}
</article>

<style>
  .project-card {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    opacity: 0;
    transform: translateY(40px);
    animation: projectFadeIn 0.8s ease-out forwards;
    animation-play-state: paused;
  }

  .project-card.visible {
    animation-play-state: running;
  }

  @keyframes projectFadeIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .project-card__inner {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
    height: auto;
  }

  @media (min-width: 1024px) {
    .project-card__inner {
      grid-template-columns: 128px 1fr 122px;
      gap: 1.5rem;
      height: 606px;
    }
  }

  /* Category */
  .project-card__category {
    display: none;
    align-items: center;
    width: 128px;
    text-align: left;
  }

  @media (min-width: 1024px) {
    .project-card__category {
      display: flex;
    }
  }

  .project-card__category span {
    writing-mode: horizontal-tb;
  }

  /* Image */
  .project-card__image-wrap {
    position: relative;
    width: 100%;
    height: 300px;
    overflow: hidden;
    border-radius: 1rem;
  }

  @media (min-width: 768px) {
    .project-card__image-wrap {
      height: 450px;
      border-radius: 1.5rem;
    }
  }

  @media (min-width: 1024px) {
    .project-card__image-wrap {
      height: 100%;
      max-width: 996px;
    }
  }

  .project-card__image-link {
    display: block;
    width: 100%;
    height: 100%;
  }

  .project-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top;
    transition: transform 0.6s ease;
  }

  .project-card__image-link:hover .project-card__image {
    transform: scale(1.03);
  }

  .project-card__overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
  }

  .project-card__image-link:hover .project-card__overlay {
    background: rgba(0, 0, 0, 0.2);
  }

  .project-card__view-btn {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-black);
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.3s ease;
  }

  .project-card__image-link:hover .project-card__view-btn {
    opacity: 1;
    transform: scale(1);
  }

  /* Meta */
  .project-card__meta {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }

  @media (min-width: 1024px) {
    .project-card__meta {
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
    }
  }

  .project-card__counter {
    display: flex;
    align-items: baseline;
  }

  .project-card__tag {
    display: flex;
  }

  /* Title */
  .project-card__title {
    text-align: center;
    display: block;
  }

  @media (min-width: 1024px) {
    .project-card__title {
      text-align: center;
    }
  }
</style>
